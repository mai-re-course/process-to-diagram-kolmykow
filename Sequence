@startuml
User -> Browser: URI 
activate Browser
alt Если нет соответствия в HSTS
Browser -> OS: Вызов функции gethostbyname
alt Если нет соответствия в кэше или в hosts файле
OS -> DNS_server: ARP request
DNS_server --> OS: ARP reply с IP 
else Если есть соответствие в кэше или в hosts
OS -> OS: IP
end
else Если есть соответствие в HSTS
Browser -> OS: IP 
end
OS -> Server_OS: TSP Handshake
OS -> Server_OS: SYN
Server_OS -> OS: SYN, ACK
OS -> Server_OS: ACL
OS -> Browser: Соединение установлено
Browser -> OS: HTTP запрос
OS-> Server_OS: TCP пакет
Server_OS -> HTTP_Server: HTTP запрос
activate HTTP_Server
HTTP_Server -> Server_OS: HTTP ответ
deactivate HTTP_Server
Server_OS -> OS: TCP пакет
OS -> Browser: HTTP ответ
alt Выключен keep-alive
OS -> Server_OS: FIN
Server_OS -> OS: ACK, FIN
OS -> Server_OS: ACK
end
Browser -> User: Отрисованная страница
deactivate Browser
@enduml

http://www.plantuml.com/plantuml/png/bLJTQXD15BwVfpWFqBv0BwIr8WbA6ph9XLTXD8CjtQOrEutqpasb2luK16y5ts0fBbrRJ5_Xd3VoV6nSrjbLAAKmytrdlldE-IQxcGOt2wT7YHcbVaRh3-ZXxFYrBZTejDSdurw4WxaB_WziN1A8lqh6jrmI_-925gIx9IzbmLVOIeOLbt99V4KzExHcTHZoktQ3-8jyu6jUAYrlvLnLRkI2InLywSF-SHgUdqtTaR_tNIhpITvpGLpY222efNeBv_nJiSBiMhXuj6F7QcYEFhVs1ZJphqvz6aoDgzVAx8e-ISxqQkeFoFWazGrR1Jp8ntyOu-9_nk2ckaQLZPzExY_UFM7uX5obRpqw6eCOsW7rt7IIxhj3twRjinrJRy6jm3NQsdxIAbVmAS3cg-7lwhJW7rmYCFs7Ipc7PSvrgw4Z1wnYqxtXS41yhMLtyaQxpLGxSh-j1NTQS8Cn_EqKfySLqYLLF-H6dMcieyugWNhYPkAx1E9PnGxZuSIgUE3uCMZrhNoMTvWB7Nf_ikwIWtb7Fe_xxNmGpHgOLZaOF8Fce4TLIjzaeOCf9KCW24R_ShaaoK00KFA2SpGUVm8sLLA_6By1
